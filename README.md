# asterisk-dialplan-regex


http://rootblog.ru/regex/

source: http://rootblog.ru/pub/src/cc2regex.tar.gz

Файлы:

- def2ext.php		Скачивание и преобразование файлов с реестром телефонных номеров.
- createqueue.php	Создание очереди элементов готовых к созданию выражения вида _123[4-6]XXX. Каждая пара элементов (0 и 1, 2 и 3 etc) определяет новое выражение, например [1234000, 1236999, 2345600, 2345699].
- regexcreator.php	Создание готовых регулярных выражений (например _123[4-6]XXX) из пары элементов (например 1234000 и 1236999), отданной createqueue.php. 

Директории:
- .tmp - директория, в которую скачиваются файлы (например, html-таблицы с телефонными номерами в кодировке WINDOWS-1251), а так же создаются временные служебные файлы.
- .code - директория с csv-таблицами кодов, которые использует программа.

Зависимости:

- PHP 5.3.0 и выше (Нужен SPL)
- awk
- grep
- wget
- iconv 

Работа:

def2ext:
	1. Скачивает файлы, создаёт csv с диапазонами, областями, опреаторами.
	2. Делает отдельный двумерный массив с диапазонами, на основе выбора пользователя (Например 9 Санкт-Петербург)
	3. Отправляет каждый диапазон в createqueue
	4. createqueue возвращает на каждый диапазон массив регулярных выражений. def2ext добавляет его к существующему.
createqueue:
	1. Получает диапазон, разбивает его на список поддиапазонов.
	2. Отправляет каждый поддиапазон в regexcreator
	3. regexcreator возвращает регулярное выражение, которое createqueue добавляет в массив регулярных выражений и после наполнения возвращает в def2ext.
regexcreator:
	1. Получает простейший поддиапазон и возвращает регулярное выражение.

